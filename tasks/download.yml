---
- name: Set official nightly URL
  set_fact:
    odoo_role_odoo_url: "{{ odoo_role_nightly_url }}"
  when:
    odoo_role_odoo_edition == "odoo"

- name: Set OCA nightly URL
  set_fact:
    odoo_role_odoo_url: "{{ odoo_role_oca_nightly_url }}"
  when:
    odoo_role_odoo_edition == "oca"

- name: Download Odoo
  get_url:
    url: "{{ odoo_role_odoo_url }}"
    dest: "{{ odoo_role_odoo_download_path }}"
    owner: "{{ odoo_role_odoo_user }}"
    group: "{{ odoo_role_odoo_group }}"

- name: Uncompress downloaded Odoo
  unarchive:
    src: "{{ odoo_role_odoo_download_path }}"
    dest: "{{ odoo_role_odoo_path }}"
    remote_src: yes
    owner: "{{ odoo_role_odoo_user }}"
    group: "{{ odoo_role_odoo_group }}"
    extra_opts: [--strip-components=1]
    #creates: "{{ odoo_role_odoo_path }}/setup.py"
